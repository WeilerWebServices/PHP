package com.mostc.pftt.results;

import java.util.List;

import com.mostc.pftt.model.core.EBuildBranch;
import com.mostc.pftt.model.core.EPhptTestStatus;

public abstract class AbstractPhptRW extends AbstractTestResultRW {
	public abstract EBuildBranch getTestPackBranch();
	public abstract String getTestPackVersion();
	@Override
	public float passRate() {
		return PhpResultPack.round1(100.0f * ((float)count(EPhptTestStatus.PASS)) / ((float)(count(EPhptTestStatus.PASS) + count(EPhptTestStatus.CRASH) + count(EPhptTestStatus.FAIL) + count(EPhptTestStatus.TIMEOUT))));
	}
	public abstract int count(EPhptTestStatus status);
	public abstract List<String> getTestNames(EPhptTestStatus status);
	
	public boolean isTooMuchChange(AbstractPhptRW base) {
		return 
				( 10 < Math.abs(count(EPhptTestStatus.FAIL) - base.count(EPhptTestStatus.FAIL)) )
				|| ( 20 < Math.abs(count(EPhptTestStatus.CRASH) - base.count(EPhptTestStatus.CRASH)))
				|| ( 100 < Math.abs(count(EPhptTestStatus.PASS) - base.count(EPhptTestStatus.PASS)))
			;
	}
	public boolean isTestStatus(String test_name, EPhptTestStatus status) {
		return getTestNames(status).contains(test_name);
	}
	
	protected void check(EPhptTestStatus status, List<String> names) {
		/*if (status==EPhptTestStatus.FAIL) {
			names.remove("ext/reflection/tests/bug36308.phpt");
			names.remove("ext/zlib/tests/ob_004.phpt");
			names.remove("zend/tests/bug40236.phpt");
			names.remove("ext/curl/tests/curl_curlopt_readdata.phpt");
			names.remove("ext/openssl/tests/openssl_spki_verify.phpt");
			names.remove("ext/zlib/tests/bug55544.phpt");
			names.remove("ext/zlib/tests/bug_52944-darwin.phpt");
			names.remove("zend/tests/bug64720.phpt");
			names.remove("ext/curl/tests/curl_copy_handle_basic_008.phpt");
			names.remove("ext/curl/tests/curl_writeheader_callback.phpt");
			names.remove("ext/filter/tests/bug52209.phpt");
			names.remove("ext/gettext/tests/gettext_basic.phpt");
			names.remove("ext/intl/tests/timezone_getdisplayname_variant3.phpt");
			names.remove("ext/mbstring/tests/mb_http_input.phpt");
			names.remove("ext/pdo_sqlite/tests/bug_63916.phpt");
			names.remove("ext/sqlite3/tests/bug63921-64bit.phpt");
			names.remove("ext/mysqli/tests/mysqli_explain_metadata.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_assoc_oo.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_all_oo.phpt");
			names.remove("ext/mysqli/tests/mysqli_poll_mixing_insert_select.phpt");
			names.remove("ext/mysqli/tests/mysqli_set_charset.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_fetch_bit.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_array.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_array_assoc.phpt");
			names.remove("ext/mysqli/tests/mysqli_options_openbasedir.phpt");
			names.remove("ext/mysqli/tests/mysqli_real_escape_string.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_bind_param.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_get_result_bit.phpt");
			names.remove("ext/bcmath/tests/bcsqrt.phpt");
			names.remove("ext/spl/tests/spldoublylinkedlist_offsetset_invalid_parameter.phpt");
			names.remove("ext/spl/tests/spldoublylinkedlist_offsetset_one_invalid_parameter.phpt");
			names.remove("ext/standard/tests/array/array_merge_recursive_variation10.phpt");
			names.remove("ext/standard/tests/array/array_rand_basic2.phpt");
			names.remove("ext/standard/tests/array/current_variation3.phpt");
			names.remove("ext/standard/tests/array/max_variation1.phpt");
			names.remove("ext/standard/tests/array/min_basic.phpt");
			names.remove("ext/standard/tests/strings/strncasecmp_variation5.phpt");
			names.remove("ext/standard/tests/strings/strncasecmp_variation8.phpt");
			names.remove("ext/standard/tests/strings/strrchr_variation6.phpt");
			names.remove("zend/tests/022.phpt");
			names.remove("zend/tests/023.phpt");
			names.remove("zend/tests/object_handlers.phpt");
			names.remove("ext/standard/tests/array/sizeof_error.phpt");
			names.remove("ext/standard/tests/network/http-stream.phpt");
			names.remove("sapi/cli/tests/bug65633.phpt");
			names.remove("tests/lang/bug32924.phpt");
			names.remove("ext/mbstring/tests/bug43841.phpt");
			names.remove("ext/mbstring/tests/mb_strrchr_error2.phpt");
			names.remove("ext/mbstring/tests/mb_substr_count_variation1.phpt");
			names.remove("ext/standard/tests/file/fscanf_variation15.phpt");
			names.remove("ext/standard/tests/streams/stream_set_chunk_size.phpt");
			names.remove("ext/standard/tests/strings/bug25671.phpt");
			names.remove("ext/standard/tests/strings/htmlentities01.phpt");
			names.remove("ext/standard/tests/strings/htmlspecialchars_decode_error.phpt");
			names.remove("ext/standard/tests/strings/strstr.phpt");
			names.remove("ext/tokenizer/tests/token_get_all_variation13.phpt");
			names.remove("zend/tests/bug31102.phpt");
			names.remove("zend/tests/class_alias_005.phpt");
			names.remove("ext/spl/tests/splfileobject_fputcsv_error.phpt");
			names.remove("ext/intl/tests/msgfmt_format_error6.phpt");
			names.remove("ext/ctype/tests/ctype_print_error.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_assoc_bit.phpt");
			names.remove("ext/mysqli/tests/mysqli_field_tell.phpt");
			names.remove("ext/mysqli/tests/mysqli_query_stored_proc.phpt");
			names.remove("ext/standard/tests/network/gethostbyname_error004.phpt");
			names.remove("tests/basic/029.phpt");
			names.remove("ext/xsl/tests/xslt006.phpt");
			names.remove("ext/xsl/tests/xsltprocessor_removeparameter.phpt");
			names.remove("zend/tests/multibyte/multibyte_encoding_004.phpt");
			names.remove("ext/mbstring/tests/mb_decode_numericentity.phpt");
			names.remove("ext/standard/tests/array/array_diff_ukey_variation7.phpt");
			names.remove("ext/standard/tests/array/end_basic.phpt");
			names.remove("ext/standard/tests/class_object/get_class_methods_variation_002.phpt");
			names.remove("ext/standard/tests/array/usort_variation7.phpt");
			names.remove("ext/standard/tests/array/usort_variation4.phpt");
			names.remove("ext/standard/tests/array/bug30266.phpt");
			names.remove("ext/spl/tests/recursiveiteratoriterator_nextelement_error.phpt");
			names.remove("ext/standard/tests/array/bug35821.phpt");
			names.remove("ext/mysqli/tests/mysqli_disable_reads_from_master.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_field_direct.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_row.phpt");
			names.remove("ext/mysqli/tests/mysqli_query.phpt");
			names.remove("ext/mysqli/tests/mysqli_query_unicode.phpt");
			names.remove("ext/mysqli/tests/mysqli_result_references_mysqlnd.phpt");
			names.remove("ext/mysqli/tests/mysqli_expire_password.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_assoc_no_alias.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_assoc_zerofill.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_lengths_oo.phpt");
			names.remove("ext/mysqli/tests/mysqli_get_warnings.phpt");
			names.remove("ext/mysqli/tests/mysqli_init.phpt");
			names.remove("ext/mysqli/tests/mysqli_real_escape_string_gbk.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_affected_rows.phpt");
			names.remove("ext/date/tests/bug33957.phpt");
			names.remove("ext/date/tests/bug34087.phpt");
			names.remove("ext/gd/tests/bug39780.phpt");
			names.remove("ext/date/tests/bug52062.phpt");
			names.remove("ext/date/tests/bug54340.phpt");
			names.remove("ext/date/tests/date_add_basic2.phpt");
			names.remove("ext/date/tests/bug20382-1.phpt");
names.remove("ext/date/tests/bug32270.phpt");
names.remove("ext/date/tests/bug49700.phpt");
names.remove("ext/date/tests/bug50680.phpt");
names.remove("ext/date/tests/bug60236.phpt");
names.remove("ext/date/tests/date_create_from_format_basic.phpt");
names.remove("ext/date/tests/date_diff1.phpt");
names.remove("ext/date/tests/date_parse_from_format_basic.phpt");
names.remove("ext/date/tests/strtotime_basic2.phpt");
names.remove("ext/ereg/tests/004.phpt");
names.remove("ext/standard/tests/file/file_get_contents_error001.phpt");
names.remove("ext/standard/tests/file/windows_links/bug48746_2.phpt");
			names.remove("ext/reflection/tests/005.phpt");
			names.remove("sapi/cli/tests/bug65066_511.phpt");
			names.remove("ext/zlib/tests/ob_001.phpt");
			names.remove("sapi/cli/tests/bug61679.phpt");
			names.remove("ext/date/tests/bug28024.phpt");
			names.remove("ext/date/tests/bug32086.phpt");
			names.remove("ext/date/tests/bug35425.phpt");
			names.remove("ext/date/tests/date_default_timezone_get-3.phpt");
			names.remove("ext/gettext/tests/gettext_phpinfo.phpt");
			names.remove("ext/xsl/tests/xsl-phpinfo.phpt");
			names.remove("tests/basic/027.phpt");
			names.remove("tests/lang/bug35176.phpt");
			names.remove("ext/standard/tests/general_functions/002.phpt");
			names.remove("ext/standard/tests/general_functions/006.phpt");
			names.remove("ext/standard/tests/strings/htmlentities.phpt");
			names.remove("ext/dom/tests/domdocument_load_variation4.phpt");
			names.remove("ext/dom/tests/domdocument_loadxml_variation4.phpt");
			names.remove("ext/mysql/tests/bug53649.phpt");
			names.remove("ext/mysqli/tests/022.phpt");
			names.remove("ext/mysqli/tests/mysqli_insert_packet_overflow.phpt");
			names.remove("ext/mysqli/tests/mysqli_set_local_infile_default.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_bind_param_many_columns.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_field.phpt");
			names.remove("ext/mysqli/tests/mysqli_insert_id_variation.phpt");
			names.remove("ext/mysqli/tests/mysqli_prepare_no_object.phpt");
			names.remove("ext/tidy/tests/020.phpt");
			names.remove("tests/basic/022.phpt");
			names.remove("tests/output/ob_018.phpt");
			names.remove("ext/filter/tests/004.phpt");
			names.remove("ext/wddx/tests/004.phpt");
			names.remove("ext/wddx/tests/005.phpt");
			names.remove("tests/func/bug64523.phpt");
			names.remove("ext/standard/tests/strings/fprintf_variation_004.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-01.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-02.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-03.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-05.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-06.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-07.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-08.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-09.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-11.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_pattern-12.phpt");
			names.remove("ext/mbstring/tests/mb_output_handler_runtime_ini_alteration-01.phpt");
			names.remove("ext/mysqli/tests/bug45289.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_field_direct_oo.phpt");
			names.remove("ext/mysqli/tests/mysqli_get_server_version.phpt");
			names.remove("ext/mysqli/tests/mysqli_prepare.phpt");
			names.remove("ext/mysqli/tests/mysqli_stmt_get_warnings.phpt");
			names.remove("sapi/cli/tests/bug65066_100.phpt");
			names.remove("sapi/cli/tests/bug65066_422.phpt");
			names.remove("ext/phar/tests/tar/phar_commitwrite.phpt");
			names.remove("ext/phar/tests/tar/phar_setsignaturealgo2.phpt");
			names.remove("ext/phar/tests/zip/phar_commitwrite.phpt");
			names.remove("ext/bcmath/tests/bcdiv.phpt");
			names.remove("ext/mysqli/tests/mysqli_multi_query.phpt");
			names.remove("ext/mysqli/tests/mysqli_rollback.phpt");
			names.remove("ext/zlib/tests/zlib_filter_deflate2.phpt");
			names.remove("ext/curl/tests/bug52202.phpt");
			names.remove("ext/curl/tests/curl_basic_008.phpt");
			names.remove("ext/curl/tests/curl_basic_010.phpt");
			names.remove("ext/curl/tests/curl_copy_handle_basic_002.phpt");
			names.remove("ext/curl/tests/curl_multi_segfault.phpt");
			names.remove("ext/curl/tests/curl_write_file.phpt");
			names.remove("ext/date/tests/big_year.phpt");
			names.remove("ext/date/tests/date_diff.phpt");
			names.remove("ext/ereg/tests/sql_regcase_error_001.phpt");
			names.remove("ext/filter/tests/033.phpt");
			names.remove("ext/intl/tests/locale_get_display_language.phpt");
			names.remove("ext/sockets/tests/bug46360.phpt");
			names.remove("ext/standard/tests/array/count_variation3.phpt");
			names.remove("ext/standard/tests/assert/assert_basic6.phpt");
			names.remove("ext/standard/tests/file/file_get_contents_error001.phpt");
			names.remove("ext/standard/tests/file/filetype_variation3.phpt");
			names.remove("ext/standard/tests/file/windows_acls/bug44859.phpt");
			names.remove("ext/standard/tests/file/windows_acls/bug44859_2.phpt");
			names.remove("ext/standard/tests/file/windows_acls/bug44859_3.phpt");
			names.remove("ext/standard/tests/file/windows_acls/bug44859_4.phpt");
			names.remove("ext/standard/tests/math/mt_srand_variation1.phpt");
			names.remove("ext/standard/tests/network/gethostbyname_basic001.phpt");
			names.remove("ext/standard/tests/network/gethostbyname_error004.phpt");
			names.remove("ext/standard/tests/network/http-stream.phpt");
			names.remove("ext/standard/tests/strings/strtok_variation7.phpt");
			names.remove("ext/xmlwriter/tests/002.phpt");
			names.remove("ext/zip/tests/bug51353.phpt");
			names.remove("sapi/cli/tests/php_cli_server_004.phpt");
			names.remove("tests/classes/private_003.phpt");
			names.remove("tests/classes/visibility_001c.phpt");
			names.remove("zend/tests/bug40770.phpt");
			names.remove("ext/mysqli/tests/010.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_all.phpt");
			names.remove("ext/mysqli/tests/mysqli_fetch_lengths.phpt");
			names.remove("ext/mysqli/tests/mysqli_query_iterators.phpt");
			names.remove("tests/lang/passbyreference_012.phpt");
			names.remove("tests/lang/returnbyreference.001.phpt");
			names.remove("tests/lang/returnbyreference.003.phpt");
		}*/
	}
}
